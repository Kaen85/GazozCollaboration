{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Kaan\\\\OneDrive\\\\Belgeler\\\\GitHub\\\\GazozCollaboration\\\\frontend\\\\src\\\\components\\\\projects\\\\ProjectIssues.js\",\n  _s = $RefreshSig$();\n// src/components/projects/ProjectIssues.js\n\nimport React, { useState, useEffect } from 'react';\nimport { useProjectContext } from '../../context/ProjectContext';\nimport { useAuth } from '../../context/AuthContext';\nimport { FiLoader, FiPlus } from 'react-icons/fi';\nimport IssueItem from './IssueItem'; // Bu component'i çağırıyoruz\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction ProjectIssues() {\n  _s();\n  const [issues, setIssues] = useState([]);\n  const [newIssueText, setNewIssueText] = useState('');\n\n  // 1. Context'ten 'currentProject'i almamız gerekiyor (Rol bilgisi için)\n  const {\n    currentProject,\n    fetchIssues,\n    createIssue,\n    loading\n  } = useProjectContext();\n  const {\n    user\n  } = useAuth(); // Yazar adını bilmek için\n\n  const projectId = currentProject === null || currentProject === void 0 ? void 0 : currentProject.id; // Proje ID'sini al\n  // 2. Kullanıcının projedeki rolünü al ('owner', 'editor', 'viewer', veya 'public_viewer')\n  const userRole = currentProject === null || currentProject === void 0 ? void 0 : currentProject.currentUserRole;\n\n  // Sayfa yüklendiğinde issue'ları çek (Değişiklik yok)\n  useEffect(() => {\n    const loadIssues = async () => {\n      try {\n        const fetchedIssues = await fetchIssues(projectId);\n        setIssues(fetchedIssues || []);\n      } catch (error) {\n        console.error(\"Failed to fetch issues:\", error);\n      }\n    };\n    if (projectId) {\n      loadIssues();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [projectId]);\n\n  // Yeni issue oluşturma formu (Değişiklik yok)\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!newIssueText.trim()) return;\n    try {\n      const newIssue = await createIssue(projectId, newIssueText);\n      setIssues([{\n        ...newIssue,\n        created_by_name: user.username\n      }, ...issues]);\n      setNewIssueText('');\n    } catch (error) {\n      console.error(\"Failed to create issue:\", error);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bg-gray-800 p-4 rounded-lg shadow-lg\",\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      className: \"text-xl font-semibold text-white mb-4\",\n      children: \"Project Issues\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }, this), (userRole === 'owner' || userRole === 'editor') && /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      className: \"flex mb-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        value: newIssueText,\n        onChange: e => setNewIssueText(e.target.value),\n        className: \"flex-grow py-2 px-3 text-gray-200 bg-gray-700 border border-gray-600 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-blue-500\",\n        placeholder: \"New issue title...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        disabled: loading,\n        className: \"flex items-center bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-3 rounded-r-lg transition-colors disabled:opacity-50\",\n        children: loading ? /*#__PURE__*/_jsxDEV(FiLoader, {\n          className: \"animate-spin\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 24\n        }, this) : /*#__PURE__*/_jsxDEV(FiPlus, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 64\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-3\",\n      children: loading && issues.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-400\",\n        children: \"Loading issues...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 11\n      }, this) : issues.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-400\",\n        children: \"No issues found for this project.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 11\n      }, this) : issues.map(issue => /*#__PURE__*/_jsxDEV(IssueItem, {\n        issue: issue,\n        projectId: projectId,\n        onIssueUpdated: handleIssueUpdate // (Bu fonksiyonu tanımlamayı unutmuşuz, ama şimdilik sorun değil)\n      }, issue.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 53,\n    columnNumber: 5\n  }, this);\n\n  // Ebeveyn listeyi güncelleme fonksiyonu (sonraki adımda ProjectIssues'e eklenmeli)\n  function handleIssueUpdate(updatedIssue) {\n    setIssues(prevIssues => prevIssues.map(issue => issue.id === updatedIssue.id ? {\n      ...issue,\n      ...updatedIssue\n    } : issue));\n  }\n}\n_s(ProjectIssues, \"XizpLER6DUSgNIf4F2K6cDd1xf8=\", false, function () {\n  return [useProjectContext, useAuth];\n});\n_c = ProjectIssues;\nexport default ProjectIssues;\nvar _c;\n$RefreshReg$(_c, \"ProjectIssues\");","map":{"version":3,"names":["React","useState","useEffect","useProjectContext","useAuth","FiLoader","FiPlus","IssueItem","jsxDEV","_jsxDEV","ProjectIssues","_s","issues","setIssues","newIssueText","setNewIssueText","currentProject","fetchIssues","createIssue","loading","user","projectId","id","userRole","currentUserRole","loadIssues","fetchedIssues","error","console","handleSubmit","e","preventDefault","trim","newIssue","created_by_name","username","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","type","value","onChange","target","placeholder","disabled","length","map","issue","onIssueUpdated","handleIssueUpdate","updatedIssue","prevIssues","_c","$RefreshReg$"],"sources":["C:/Users/Kaan/OneDrive/Belgeler/GitHub/GazozCollaboration/frontend/src/components/projects/ProjectIssues.js"],"sourcesContent":["// src/components/projects/ProjectIssues.js\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useProjectContext } from '../../context/ProjectContext';\r\nimport { useAuth } from '../../context/AuthContext';\r\nimport { FiLoader, FiPlus } from 'react-icons/fi';\r\nimport IssueItem from './IssueItem'; // Bu component'i çağırıyoruz\r\n\r\nfunction ProjectIssues() {\r\n  const [issues, setIssues] = useState([]);\r\n  const [newIssueText, setNewIssueText] = useState('');\r\n  \r\n  // 1. Context'ten 'currentProject'i almamız gerekiyor (Rol bilgisi için)\r\n  const { currentProject, fetchIssues, createIssue, loading } = useProjectContext();\r\n  const { user } = useAuth(); // Yazar adını bilmek için\r\n\r\n  const projectId = currentProject?.id; // Proje ID'sini al\r\n  // 2. Kullanıcının projedeki rolünü al ('owner', 'editor', 'viewer', veya 'public_viewer')\r\n  const userRole = currentProject?.currentUserRole;\r\n\r\n  // Sayfa yüklendiğinde issue'ları çek (Değişiklik yok)\r\n  useEffect(() => {\r\n    const loadIssues = async () => {\r\n      try {\r\n        const fetchedIssues = await fetchIssues(projectId);\r\n        setIssues(fetchedIssues || []);\r\n      } catch (error) {\r\n        console.error(\"Failed to fetch issues:\", error);\r\n      }\r\n    };\r\n    \r\n    if (projectId) {\r\n      loadIssues();\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [projectId]); \r\n\r\n  // Yeni issue oluşturma formu (Değişiklik yok)\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    if (!newIssueText.trim()) return; \r\n\r\n    try {\r\n      const newIssue = await createIssue(projectId, newIssueText);\r\n      setIssues([{ ...newIssue, created_by_name: user.username }, ...issues]);\r\n      setNewIssueText(''); \r\n    } catch (error) {\r\n      console.error(\"Failed to create issue:\", error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-gray-800 p-4 rounded-lg shadow-lg\">\r\n      <h3 className=\"text-xl font-semibold text-white mb-4\">Project Issues</h3>\r\n      \r\n      {/* === 3. DÜZELTME: FORM GİZLEME === */}\r\n      {/* Bu formu SADECE 'viewer' veya 'public_viewer' OLMAYANLARA göster */}\r\n      {/* (Backend kuralı: Sadece 'owner' ve 'editor' ekleyebilir) */}\r\n      {(userRole === 'owner' || userRole === 'editor') && (\r\n        <form onSubmit={handleSubmit} className=\"flex mb-4\">\r\n          <input \r\n            type=\"text\"\r\n            value={newIssueText}\r\n            onChange={(e) => setNewIssueText(e.target.value)}\r\n            className=\"flex-grow py-2 px-3 text-gray-200 bg-gray-700 border border-gray-600 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n            placeholder=\"New issue title...\"\r\n          />\r\n          <button \r\n            type=\"submit\" \r\n            disabled={loading}\r\n            className=\"flex items-center bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-3 rounded-r-lg transition-colors disabled:opacity-50\"\r\n          >\r\n            {loading ? <FiLoader className=\"animate-spin\" /> : <FiPlus />}\r\n          </button>\r\n        </form>\r\n      )}\r\n\r\n      {/* Issue Listesi (Değişiklik yok) */}\r\n      <div className=\"space-y-3\">\r\n        {loading && issues.length === 0 ? (\r\n          <p className=\"text-gray-400\">Loading issues...</p>\r\n        ) : issues.length === 0 ? (\r\n          <p className=\"text-gray-400\">No issues found for this project.</p>\r\n        ) : (\r\n          issues.map(issue => (\r\n            <IssueItem \r\n              key={issue.id} \r\n              issue={issue} \r\n              projectId={projectId} \r\n              onIssueUpdated={handleIssueUpdate} // (Bu fonksiyonu tanımlamayı unutmuşuz, ama şimdilik sorun değil)\r\n            />\r\n          ))\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n  \r\n  // Ebeveyn listeyi güncelleme fonksiyonu (sonraki adımda ProjectIssues'e eklenmeli)\r\n  function handleIssueUpdate(updatedIssue) {\r\n    setIssues(prevIssues => \r\n      prevIssues.map(issue => \r\n        issue.id === updatedIssue.id ? { ...issue, ...updatedIssue } : issue\r\n      )\r\n    );\r\n  }\r\n}\r\n\r\nexport default ProjectIssues;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}