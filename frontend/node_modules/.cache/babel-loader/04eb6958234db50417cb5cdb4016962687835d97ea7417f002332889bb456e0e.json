{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Kaan\\\\OneDrive\\\\Belgeler\\\\GitHub\\\\GazozCollaboration\\\\frontend\\\\src\\\\components\\\\projects\\\\IssueItem.js\",\n  _s = $RefreshSig$();\n// src/components/projects/IssueItem.js (YENİ DOSYA)\n\nimport React, { useState } from 'react';\nimport { FiMessageSquare, FiChevronDown, FiChevronRight, FiLoader } from 'react-icons/fi';\nimport { useProjectContext } from '../../context/ProjectContext';\nimport Comment from './Comment'; // (Zaten var olan Comment.js'i kullanır)\nimport CommentForm from './CommentForm'; // (Zaten var olan CommentForm.js'i kullanır)\n\n// Bu component 'issue' (sorun) ve 'projectId' bilgilerini prop olarak alır\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction IssueItem({\n  issue,\n  projectId\n}) {\n  _s();\n  // 1. Yorumların açık/kapalı olma durumu (varsayılan: kapalı)\n  const [isOpen, setIsOpen] = useState(false);\n  // 2. Bu issue'ya ait yorumların listesi\n  const [comments, setComments] = useState([]);\n  // 3. Yorumların yüklenme durumu\n  const [loadingComments, setLoadingComments] = useState(false);\n  const {\n    fetchIssueComments,\n    addIssueComment,\n    loading: contextLoading\n  } = useProjectContext();\n\n  // 4. \"Buton\"a tıklandığında çalışacak fonksiyon\n  const toggleComments = async () => {\n    // Eğer zaten açıksa, kapat\n    if (isOpen) {\n      setIsOpen(false);\n      return;\n    }\n\n    // Eğer kapalıysa, aç ve yorumları backend'den çek\n    setIsOpen(true);\n    setLoadingComments(true);\n    try {\n      const fetchedComments = await fetchIssueComments(projectId, issue.id);\n      setComments(fetchedComments || []);\n    } catch (error) {\n      console.error(\"Failed to fetch issue comments:\", error);\n    } finally {\n      setLoadingComments(false);\n    }\n  };\n\n  // 5. Bu issue'ya yeni bir yorum eklendiğinde çalışır\n  const handleCommentAdded = async text => {\n    try {\n      // 'addComment' değil, 'addIssueComment' fonksiyonunu çağır\n      const newComment = await addIssueComment(projectId, issue.id, text);\n      // Yeni yorumu listeye ekle\n      setComments([...comments, newComment]);\n    } catch (error) {\n      console.error(\"Failed to add issue comment:\", error);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bg-gray-700 rounded-md\",\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: toggleComments,\n      className: \"w-full flex justify-between items-center p-3 text-left\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-1\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-white font-medium\",\n          children: issue.text\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 61,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xs text-gray-400\",\n          children: [\"Opened by \", issue.created_by_name || '...']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center text-gray-400\",\n        children: [/*#__PURE__*/_jsxDEV(FiMessageSquare, {\n          size: 16,\n          className: \"mr-2\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 11\n        }, this), isOpen ? /*#__PURE__*/_jsxDEV(FiChevronDown, {\n          size: 20\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 21\n        }, this) : /*#__PURE__*/_jsxDEV(FiChevronRight, {\n          size: 20\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 51\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 7\n    }, this), isOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-4 border-t border-gray-600\",\n      children: [loadingComments ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-center p-3\",\n        children: /*#__PURE__*/_jsxDEV(FiLoader, {\n          className: \"animate-spin text-blue-400\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-4 mb-4\",\n        children: comments.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-500 text-sm text-center\",\n          children: \"No comments yet.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 17\n        }, this) : comments.map(comment => /*#__PURE__*/_jsxDEV(Comment, {\n          comment: comment\n        }, comment.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 19\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(CommentForm, {\n        projectId: projectId\n        // 'onCommentAdded' prop'unu (ProjectDiscussion'dan farklı olarak)\n        // 'addIssueComment' fonksiyonunu çağırmak için yeniden tanımlıyoruz.\n        // Bu, 'CommentForm.js' dosyanızın nasıl yazıldığına bağlıdır.\n        // BASİTLEŞTİRME: Yorum formunu 'CommentForm.js' yerine buraya taşıyalım.\n\n        // ---> BASİTLEŞTİRME: 'CommentForm.js'i (karmaşıklığı önlemek için)\n        // burada yeniden yazıyoruz:\n        ,\n        onSubmit: handleCommentAdded // Bu, 'CommentForm.js'i değiştirmenizi gerektirir\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 54,\n    columnNumber: 5\n  }, this);\n}\n_s(IssueItem, \"ATtCcEy8mBKzNqbm4A/TqKZmUXo=\", false, function () {\n  return [useProjectContext];\n});\n_c = IssueItem;\nexport default IssueItem;\nvar _c;\n$RefreshReg$(_c, \"IssueItem\");","map":{"version":3,"names":["React","useState","FiMessageSquare","FiChevronDown","FiChevronRight","FiLoader","useProjectContext","Comment","CommentForm","jsxDEV","_jsxDEV","IssueItem","issue","projectId","_s","isOpen","setIsOpen","comments","setComments","loadingComments","setLoadingComments","fetchIssueComments","addIssueComment","loading","contextLoading","toggleComments","fetchedComments","id","error","console","handleCommentAdded","text","newComment","className","children","onClick","fileName","_jsxFileName","lineNumber","columnNumber","created_by_name","size","length","map","comment","onSubmit","_c","$RefreshReg$"],"sources":["C:/Users/Kaan/OneDrive/Belgeler/GitHub/GazozCollaboration/frontend/src/components/projects/IssueItem.js"],"sourcesContent":["// src/components/projects/IssueItem.js (YENİ DOSYA)\r\n\r\nimport React, { useState } from 'react';\r\nimport { FiMessageSquare, FiChevronDown, FiChevronRight, FiLoader } from 'react-icons/fi';\r\nimport { useProjectContext } from '../../context/ProjectContext';\r\nimport Comment from './Comment'; // (Zaten var olan Comment.js'i kullanır)\r\nimport CommentForm from './CommentForm'; // (Zaten var olan CommentForm.js'i kullanır)\r\n\r\n// Bu component 'issue' (sorun) ve 'projectId' bilgilerini prop olarak alır\r\nfunction IssueItem({ issue, projectId }) {\r\n  // 1. Yorumların açık/kapalı olma durumu (varsayılan: kapalı)\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  // 2. Bu issue'ya ait yorumların listesi\r\n  const [comments, setComments] = useState([]);\r\n  // 3. Yorumların yüklenme durumu\r\n  const [loadingComments, setLoadingComments] = useState(false);\r\n  \r\n  const { fetchIssueComments, addIssueComment, loading: contextLoading } = useProjectContext();\r\n\r\n  // 4. \"Buton\"a tıklandığında çalışacak fonksiyon\r\n  const toggleComments = async () => {\r\n    // Eğer zaten açıksa, kapat\r\n    if (isOpen) {\r\n      setIsOpen(false);\r\n      return;\r\n    }\r\n\r\n    // Eğer kapalıysa, aç ve yorumları backend'den çek\r\n    setIsOpen(true);\r\n    setLoadingComments(true);\r\n    try {\r\n      const fetchedComments = await fetchIssueComments(projectId, issue.id);\r\n      setComments(fetchedComments || []);\r\n    } catch (error) {\r\n      console.error(\"Failed to fetch issue comments:\", error);\r\n    } finally {\r\n      setLoadingComments(false);\r\n    }\r\n  };\r\n\r\n  // 5. Bu issue'ya yeni bir yorum eklendiğinde çalışır\r\n  const handleCommentAdded = async (text) => {\r\n    try {\r\n      // 'addComment' değil, 'addIssueComment' fonksiyonunu çağır\r\n      const newComment = await addIssueComment(projectId, issue.id, text);\r\n      // Yeni yorumu listeye ekle\r\n      setComments([...comments, newComment]);\r\n    } catch (error) {\r\n      console.error(\"Failed to add issue comment:\", error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-gray-700 rounded-md\">\r\n      {/* 6. Asıl \"Buton\" (Issue Başlığı) */}\r\n      <button \r\n        onClick={toggleComments}\r\n        className=\"w-full flex justify-between items-center p-3 text-left\"\r\n      >\r\n        <div className=\"flex-1\">\r\n          <p className=\"text-white font-medium\">{issue.text}</p>\r\n          <span className=\"text-xs text-gray-400\">\r\n            Opened by {issue.created_by_name || '...'}\r\n          </span>\r\n        </div>\r\n        <div className=\"flex items-center text-gray-400\">\r\n          <FiMessageSquare size={16} className=\"mr-2\" />\r\n          {/* <span className=\"text-xs mr-2\">{issue.commentCount || 0}</span> */}\r\n          {isOpen ? <FiChevronDown size={20} /> : <FiChevronRight size={20} />}\r\n        </div>\r\n      </button>\r\n\r\n      {/* 7. AÇILIR YORUM BÖLÜMÜ */}\r\n      {/* 'isOpen' true ise burası görünür */}\r\n      {isOpen && (\r\n        <div className=\"p-4 border-t border-gray-600\">\r\n          {loadingComments ? (\r\n            <div className=\"flex justify-center p-3\">\r\n              <FiLoader className=\"animate-spin text-blue-400\" />\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-4 mb-4\">\r\n              {comments.length === 0 ? (\r\n                <p className=\"text-gray-500 text-sm text-center\">No comments yet.</p>\r\n              ) : (\r\n                comments.map(comment => (\r\n                  <Comment key={comment.id} comment={comment} />\r\n                ))\r\n              )}\r\n            </div>\r\n          )}\r\n          \r\n          {/* Yorum Ekleme Formu */}\r\n          {/* NOT: Bu CommentForm'un 'onCommentAdded' prop'unu desteklemesi lazım\r\n               (Bir önceki adımdaki 'ProjectDiscussion' için yazdığımız gibi)\r\n               Eğer 'CommentForm.js' dosyanız 'onCommentAdded' yerine 'addComment'\r\n               gibi bir fonksiyon bekliyorsa, burayı ona göre güncellemeliyiz.\r\n               Şimdilik, 'CommentForm'un 'onSubmit'te 'addIssueComment'i\r\n               çağırmasını sağlayacak şekilde basitleştirelim.\r\n          */}\r\n          <CommentForm \r\n            projectId={projectId} \r\n            // 'onCommentAdded' prop'unu (ProjectDiscussion'dan farklı olarak)\r\n            // 'addIssueComment' fonksiyonunu çağırmak için yeniden tanımlıyoruz.\r\n            // Bu, 'CommentForm.js' dosyanızın nasıl yazıldığına bağlıdır.\r\n            // BASİTLEŞTİRME: Yorum formunu 'CommentForm.js' yerine buraya taşıyalım.\r\n            \r\n            // ---> BASİTLEŞTİRME: 'CommentForm.js'i (karmaşıklığı önlemek için)\r\n            // burada yeniden yazıyoruz:\r\n            onSubmit={handleCommentAdded} // Bu, 'CommentForm.js'i değiştirmenizi gerektirir\r\n          />\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default IssueItem;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}