{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Kaan\\\\OneDrive\\\\Belgeler\\\\GitHub\\\\GazozCollaboration\\\\frontend\\\\src\\\\context\\\\AuthContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useState, useEffect } from 'react';\nimport api from '../services/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext();\nexport function useAuth() {\n  _s();\n  return useContext(AuthContext);\n}\n_s(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nexport function AuthProvider({\n  children\n}) {\n  _s2();\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  // 1. Sayfa Yüklendiğinde (Basitleştirildi: Çökme Korumalı)\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      // Backend ile teyit etmeye çalışmak yerine, token varsa oturumu açık sayıyoruz.\n      // Bu sayede \"404\" hatası alıp ekran beyazlamaz.\n      setUser({\n        username: \"SessionRestored\"\n      });\n    }\n    setLoading(false);\n  }, []);\n\n  // 2. Login Fonksiyonu\n  const login = async (username, password) => {\n    try {\n      const res = await api.post('/api/auth/login', {\n        username,\n        password\n      });\n      if (res.data.token) {\n        localStorage.setItem('token', res.data.token);\n        // Login olunca user bilgisini set et\n        setUser(res.data.user || {\n          username: username\n        });\n        return true;\n      }\n    } catch (error) {\n      console.error(\"Login Failed:\", error);\n      throw error;\n    }\n  };\n\n  // 3. Register Fonksiyonu\n  const register = async (username, email, password) => {\n    const res = await api.post('/api/auth/register', {\n      username,\n      email,\n      password\n    });\n    if (res.data.token) {\n      localStorage.setItem('token', res.data.token);\n      setUser(res.data.user);\n    }\n  };\n\n  // 4. Logout Fonksiyonu\n  const logout = () => {\n    localStorage.removeItem('token');\n    setUser(null);\n    // Sayfayı yenile ki state tamamen temizlensin\n    window.location.href = '/login';\n  };\n  const value = {\n    user,\n    login,\n    register,\n    logout,\n    loading\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: value,\n    children: !loading && children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 68,\n    columnNumber: 5\n  }, this);\n}\n_s2(AuthProvider, \"NiO5z6JIqzX62LS5UWDgIqbZYyY=\");\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","api","jsxDEV","_jsxDEV","AuthContext","useAuth","_s","AuthProvider","children","_s2","user","setUser","loading","setLoading","token","localStorage","getItem","username","login","password","res","post","data","setItem","error","console","register","email","logout","removeItem","window","location","href","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/Kaan/OneDrive/Belgeler/GitHub/GazozCollaboration/frontend/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport api from '../services/api';\r\n\r\nconst AuthContext = createContext();\r\n\r\nexport function useAuth() {\r\n  return useContext(AuthContext);\r\n}\r\n\r\nexport function AuthProvider({ children }) {\r\n  const [user, setUser] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // 1. Sayfa Yüklendiğinde (Basitleştirildi: Çökme Korumalı)\r\n  useEffect(() => {\r\n    const token = localStorage.getItem('token');\r\n    if (token) {\r\n      // Backend ile teyit etmeye çalışmak yerine, token varsa oturumu açık sayıyoruz.\r\n      // Bu sayede \"404\" hatası alıp ekran beyazlamaz.\r\n      setUser({ username: \"SessionRestored\" }); \r\n    }\r\n    setLoading(false);\r\n  }, []);\r\n\r\n  // 2. Login Fonksiyonu\r\n  const login = async (username, password) => {\r\n    try {\r\n      const res = await api.post('/api/auth/login', { username, password });\r\n      \r\n      if (res.data.token) {\r\n        localStorage.setItem('token', res.data.token);\r\n        // Login olunca user bilgisini set et\r\n        setUser(res.data.user || { username: username }); \r\n        return true;\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Login Failed:\", error);\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  // 3. Register Fonksiyonu\r\n  const register = async (username, email, password) => {\r\n    const res = await api.post('/api/auth/register', { username, email, password });\r\n    if (res.data.token) {\r\n        localStorage.setItem('token', res.data.token);\r\n        setUser(res.data.user);\r\n    }\r\n  };\r\n\r\n  // 4. Logout Fonksiyonu\r\n  const logout = () => {\r\n    localStorage.removeItem('token');\r\n    setUser(null);\r\n    // Sayfayı yenile ki state tamamen temizlensin\r\n    window.location.href = '/login';\r\n  };\r\n\r\n  const value = {\r\n    user,\r\n    login,\r\n    register,\r\n    logout,\r\n    loading\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={value}>\r\n      {!loading && children}\r\n    </AuthContext.Provider>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}